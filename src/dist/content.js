(()=>{"use strict";var e={variables:{DeadZone:.2,MinInterval:200},keymapping:{buttons:{1:{action:"seekForward",params:{seconds:5}},2:{action:"seekForward",params:{seconds:-1}},7:{action:"setSpeed"},10:{action:"fullscreenToggle"},11:{action:"pauseOrPlay"},14:{action:"seekForward",params:{seconds:-5}}}}},t=Object.freeze({button:"button",axis:"axis"}),n={isHolding:!1,lastPressTimestamp:0,isSpeedRestored:!0};function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,i(a.key),a)}}function r(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}var l=e;chrome.storage.sync.get({config:e},function(e){l=e.config}),chrome.storage.onChanged.addListener(function(e,t){"sync"===t&&e.config&&(l=e.config.newValue)}),Object.freeze({EnableListening:"enableListening",DisableListening:"disableListening",KeyPressed:"keyPressed",GetSpeed:"getSpeed",SetSpeed:"setSpeed",SeekForward:"seekForward",PauseOrPlay:"pauseOrPlay",FullscreenToggle:"fullscreenToggle"});var u=new(function(){return r(function e(t){o(this,e),this.toast=t},[{key:"getSpeed",value:function(){var e=document.querySelector("video");return e?e.playbackRate:(console.log("No video element found on the page."),null)}},{key:"setSpeed",value:function(e){if(this.getSpeed()!==e){var t=document.querySelector("video");t?t.playbackRate=e:console.log("No video element found on the page."),this.toast.setContent("Speed: ".concat(Math.floor(100*this.getSpeed())/100))}}},{key:"seekForward",value:function(e){var t=document.querySelector("video");t?(t.currentTime+=e,e>0?this.toast.setContent(">> ".concat(e,"s")):this.toast.setContent("<< ".concat(e,"s"))):console.log("No video element found on the page.")}},{key:"pauseOrPlay",value:function(){var e=document.querySelector("video");e.paused?e.play():e.pause()}},{key:"fullscreenToggle",value:function(){var e=document.querySelector("video");e?document.fullscreenElement?document.exitFullscreen():e.requestFullscreen():console.log("No video element found on the page.")}}])}())(new(function(){return r(function e(){if(o(this,e),this.start=0,this.toast=document.getElementById("toast"),null==this.toast){console.log("Creating toast element...");var t=document.createElement("style");t.textContent="\n#toast {\n  visibility: hidden;\n  opacity: 0.5;\n  z-index: 9999;\n  min-width: 250px;\n  margin-left: -125px;\n  background-color: #333;\n  color: #fff;\n  text-align: center;\n  border-radius: 2px;\n  padding: 16px;\n  position: fixed;\n  left: 50%;\n  bottom: 30px;\n  font-size: 17px;\n}\n\n#toast.show {\n  visibility: visible;\n  display: block;\n  -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;\n  animation: fadein 0.5s, fadeout 0.5s 2.5s;\n}\n            ",document.head.appendChild(t),this.toast=document.createElement("div"),this.toast.id="toast",document.body.appendChild(this.toast)}},[{key:"setContent",value:function(e){var t=this;this.start=(new Date).getTime(),this.toast.className="show",this.toast.textContent=e,setTimeout(function(){t.start+3e3<=(new Date).getTime()&&(t.toast.className=t.toast.className.replace("show",""))},3e3)}}])}()));function c(){var e=navigator.getGamepads();if(e&&0!==e.length){var a=e[0];if(a){var o=function(e,a){var o=function(e,n){for(var a=n&&n.variables&&n.variables.DeadZone?n.variables.DeadZone:.2,o=null,s=null,r=null,i=0;i<e.axes.length;i++)if(e.axes[i]&&Math.abs(e.axes[i])>a){o=t.axis,s=i,r=(e.axes[i]-a)/(1-a);break}if(null===s)for(var l=0;l<e.buttons.length;l++)if(e.buttons[l]&&e.buttons[l].value>a){o=t.button,s=l,r=(e.buttons[l].value-a)/(1-a);break}return null===s?null:{type:o,idx:s,val:r}}(e,a),s=a&&a.variables&&a.variables.MinInterval?a.variables.MinInterval:200;if(null===o)return n.isHolding=!1,n.isSpeedRestored?null:(n.isSpeedRestored=!0,{action:"setSpeed",params:{speed:1}});var r=(new Date).getTime();if(n.isHolding&&r-n.lastPressTimestamp<s)return null;n.isHolding=!0,n.lastPressTimestamp=r,n.isSpeedRestored=!1;var i=Math.floor(100*o.val)/100;if(!a||!a.keymapping||!a.keymapping.buttons)return null;var l=a.keymapping.buttons[o.idx];if(!l)return null;switch(l.action){case"seekForward":if(l.params)return{action:"seekForward",params:l.params};break;case"setSpeed":return{action:"setSpeed",params:{speed:l.params&&void 0!==l.params.speed?l.params.speed:i<=.5?1+2*i:2+4*(i-.5)}};case"fullscreenToggle":return{action:"fullscreenToggle"};case"pauseOrPlay":return{action:"pauseOrPlay"}}return null}(a,l);if(o)switch(o.action){case"seekForward":u.seekForward(o.params.seconds);break;case"setSpeed":u.setSpeed(o.params.speed);break;case"fullscreenToggle":u.fullscreenToggle();break;case"pauseOrPlay":u.pauseOrPlay()}requestAnimationFrame(c)}else requestAnimationFrame(c)}else requestAnimationFrame(c)}window.addEventListener("gamepadconnected",function(){console.log("Initializing content script..."),console.log("Starting gamepad input listener..."),c()})})();